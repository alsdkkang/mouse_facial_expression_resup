{"cells":[{"cell_type":"markdown","metadata":{"id":"j1myjJNiSkUt"},"source":["# Mouse Facial Expressions - GPU Training\n","\n","ì´ ë…¸íŠ¸ë¶ì€ Google Colab ë˜ëŠ” Kaggle GPUì—ì„œ ëª¨ë¸ì„ í•™ìŠµí•˜ê¸° ìœ„í•œ ê²ƒì…ë‹ˆë‹¤.\n","\n","## ì‚¬ìš© ë°©ë²•:\n","1. Google Colabì—ì„œ ì—´ê¸°: File > Upload notebook\n","2. Runtime > Change runtime type > GPU ì„ íƒ\n","3. ëª¨ë“  ì…€ì„ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰\n","\n","## ì˜ˆìƒ ì‹œê°„:\n","- GPU (T4/V100): 30ë¶„ - 1ì‹œê°„\n","- CPU: 7-8ì‹œê°„"]},{"cell_type":"markdown","metadata":{"id":"T5b5Qj0qSkUu"},"source":["## Step 1: í™˜ê²½ ì„¤ì • ë° ë°ì´í„° ì—…ë¡œë“œ"]},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4tzrN1YPSkUu","executionInfo":{"status":"ok","timestamp":1763911051974,"user_tz":300,"elapsed":7085,"user":{"displayName":"Mina Kang","userId":"09171318576601785204"}},"outputId":"e3dd366e-f04a-4764-ad31-1f71dca1906d"},"outputs":[{"output_type":"stream","name":"stdout","text":["CUDA available: True\n","GPU: Tesla T4\n","GPU Memory: 15.83 GB\n"]}],"source":["# GPU í™•ì¸\n","import torch\n","print(f\"CUDA available: {torch.cuda.is_available()}\")\n","if torch.cuda.is_available():\n","    print(f\"GPU: {torch.cuda.get_device_name(0)}\")\n","    print(f\"GPU Memory: {torch.cuda.get_device_properties(0).total_memory / 1e9:.2f} GB\")"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"k1T2v6oeSkUu","executionInfo":{"status":"ok","timestamp":1763911068600,"user_tz":300,"elapsed":16624,"user":{"displayName":"Mina Kang","userId":"09171318576601785204"}},"outputId":"3eb26fec-0a58-4f4f-ac0b-5e1e8c53bea4"},"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[2K     \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m42.4/42.4 kB\u001b[0m \u001b[31m2.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m40.0/40.0 kB\u001b[0m \u001b[31m3.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m827.9/827.9 kB\u001b[0m \u001b[31m24.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m8.9/8.9 MB\u001b[0m \u001b[31m134.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m2.4/2.4 MB\u001b[0m \u001b[31m109.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m84.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m983.2/983.2 kB\u001b[0m \u001b[31m71.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m147.8/147.8 kB\u001b[0m \u001b[31m15.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m114.9/114.9 kB\u001b[0m \u001b[31m12.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m85.0/85.0 kB\u001b[0m \u001b[31m6.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m76.8/76.8 kB\u001b[0m \u001b[31m7.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m831.6/831.6 kB\u001b[0m \u001b[31m65.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m753.9/753.9 kB\u001b[0m \u001b[31m61.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m207.3/207.3 kB\u001b[0m \u001b[31m20.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h"]}],"source":["# í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜\n","!pip install -q lightning mlflow torchmetrics scikit-image pandas tqdm"]},{"cell_type":"markdown","metadata":{"id":"u3Vt623ySkUu"},"source":["### ë°ì´í„° ì—…ë¡œë“œ\n","\n","**ë°©ë²• 1: Google Drive ë§ˆìš´íŠ¸ (ì¶”ì²œ)**\n","- ë°ì´í„°ë¥¼ Google Driveì— ì—…ë¡œë“œ\n","- ì•„ë˜ ì…€ ì‹¤í–‰í•˜ì—¬ ë§ˆìš´íŠ¸\n","\n","**ë°©ë²• 2: ì§ì ‘ ì—…ë¡œë“œ**\n","- ì¢Œì¸¡ íŒŒì¼ íƒ­ì—ì„œ ì—…ë¡œë“œ\n","- `data.zip` íŒŒì¼ ì—…ë¡œë“œ í›„ ì••ì¶• í•´ì œ"]},{"cell_type":"code","execution_count":11,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8G__dQdCSkUu","executionInfo":{"status":"ok","timestamp":1763911921902,"user_tz":300,"elapsed":533,"user":{"displayName":"Mina Kang","userId":"09171318576601785204"}},"outputId":"232682d5-626e-4073-d711-d4ab1c684159"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["# Google Drive ë§ˆìš´íŠ¸ (ì„ íƒì‚¬í•­)\n","from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","source":["\n","!ls /content/drive/MyDrive"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"JGXkmZnMXFy8","executionInfo":{"status":"ok","timestamp":1763912226561,"user_tz":300,"elapsed":106,"user":{"displayName":"Mina Kang","userId":"09171318576601785204"}},"outputId":"c4c1dff0-953f-4398-a898-7752793ebaff"},"execution_count":21,"outputs":[{"output_type":"stream","name":"stdout","text":[" 2024á„‚á…§á†«+á„á…©á†¼á„€á…¨á„ƒá…¦á„‹á…µá„á…¥+á„’á…ªá†¯á„‹á…­á†¼á„ƒá…¢á„’á…¬+á„€á…§á†¯á„€á…ª+á„‡á…¡á†¯á„‘á…­+á„‡á…©á„ƒá…©á„Œá…¡á„…á…­.pdf\n","'2025 holiday party'\n","'2025á„‚á…§á†« á„á…©á†¼á„€á…¨á„ƒá…¦á„‹á…µá„á…¥ á„’á…ªá†¯á„‹á…­á†¼á„ƒá…¢á„’á…¬ á„‹á…¡á†«á„‚á…¢á„†á…®á†«.pdf'\n","'2025á„‚á…§á†« á„á…©á†¼á„€á…¨á„ƒá…¦á„‹á…µá„á…¥ á„’á…ªá†¯á„‹á…­á†¼á„ƒá…¢á„’á…¬ á„á…¡á†·á„€á…¡ á„‰á…µá†«á„á…¥á†¼ á„€á…¡á„‹á…µá„ƒá…³_á„‰á…®á„Œá…¥á†¼.pdf'\n","'93 Norman-Amenity Room Reservation Form.pdf'\n","'Abizaid Lab Data Analysis Platform.gform'\n"," AbizaidWebsiteInfo.docx\n","'Abstract_Ottawa Symposium for AI in Health Research.gdoc'\n","'acceptance letter.pdf'\n","'Alfonso lab pic'\n","'Alfonso Lab - Website.gdoc'\n","'APPLE COVERLETTER.gdoc'\n","'Assignment 1_Mina Kang (101390393).gdoc'\n","'assignment 2 draft.gdoc'\n","'Assignment 2 â€“ Linear Relationships with Continuous Predictors: Correlations, Multiple & Hierarchical Regressions.gdoc'\n"," certificate_enrollment.pdf\n","'ChatGPT blogs.docx'\n"," CMOS\n","'Colab Notebooks'\n","'Cover Letter_CCS.gdoc'\n","'Cover Letter_Lamour.gdoc'\n","'Cover Letter_Mina Kang_LAMOUR BEAUTY & LIFE.gdoc'\n","'Cover Ltter_Mina Kang_ESP.gdoc'\n","'CURRENT PROJECTS.docx'\n","'CV_Kelello Health.gdoc'\n","'CV_Mina Kang_4á„‹á…¯á†¯ á„á…¬á„Œá…©á†¼ á„‰á…®á„Œá…¥á†¼.gdoc'\n","'CV_Mina Kang_BDO.gdoc'\n","'CV - Mina Kang for Data and Analytics (Business Intelligence) Specialist at Canadian Cancer Society.gdoc'\n","'CV_Mina Kang.gdoc'\n","'CV_Mina Kang_ Instacart.gdoc'\n","'CV_Mina Kang.pdf'\n","'CV_Mina Kang_YELP.gdoc'\n"," CV_MINAKNAG_05.gdoc\n"," Documents.zip\n"," draft.pptx\n","'Epistream website.docx'\n","'Exploring Potential Collaboration Between the Abizaid Lab and SAMÂ³ Lab.gdoc'\n","'Foundations in Statistics for Neuroscience'\n","'Fundamentals in Neuroscience - NEUR 5100 - T'\n"," GoodNotes\n"," Graduate-Awards-Presentation-2025.pdf\n"," Graduate-Student-Handbook-2026-.pdf\n"," Graduate-Student-Handbook-June-2023.pdf\n"," header_01.gif\n","'IDEA .gdoc'\n","'IELTS Academic Writing á„á…¬á„Œá…©á†¼ á„Œá…¥á†¼á„…á…µá„‡á…©á†« (5.5â†’6.0).pdf'\n"," IMG_5299.CR2\n"," IMG_5300.CR2\n","'Information Guide.gdoc'\n"," International_Transcript_Request1.pdf\n","'International_Transcript_Request (1).pdf'\n"," International_Transcript_Request.pdf\n","'job hunting.gdoc'\n"," KakaoTalk_20250429_080644633_01.jpg\n"," KakaoTalk_20250429_080644633_02.jpg\n"," KakaoTalk_20250429_080644633_03.jpg\n"," KakaoTalk_20250429_080644633_04.jpg\n","'Korea Trip   á„’á…¡á†«á„€á…®á†¨ á„‹á…§á„’á…¢á†¼.gsheet'\n","'Lab meeting .gdoc'\n","'lab work text books'\n","'Lazara Jimenez. Lab website.docx'\n"," Letter_Mina%20Kang.pdf.pdf\n","'Letter_Mina Kang.docx'\n"," Link.gdoc\n","'matrix for 2025.gsheet'\n","'mina coffee.jpg'\n"," Mina_Kang_CoverLetter_BDO.gdoc\n"," Mina_Kang_CoverLetter_Bluewaveai.gdoc\n","'Mina_Kang_Cover letter_Instamarket.gdoc'\n"," Mina_Kang_CoverLetter_Yelp.gdoc\n"," Mina_Kang_CV_Bluewaveai.gdoc\n","'Mina letter to IRCC.pdf'\n","'Mind Map.png'\n","' Mitacs Accelerate á„á…¥á†º á„†á…µá„á…µá†¼.gdoc'\n","'Mitacs open projects.gdoc'\n"," moouse_move_track.py\n"," mouse_behaviour\n"," mouse-facial-expressions-2023-main\n","'My conversation with Andre about his project.gdoc'\n","'neur 5100 bcj.gdoc'\n","'NEUR 5100 Journal Club (Mina Kang).pdf'\n","'Neur 5100_Nov 5.gdoc'\n","'NEUR 5201 - Assignment 1: Data Screening & Cleaning.gdoc'\n"," Outlook\n"," page_back.gif\n","'Paul website '\n","'Photo Booth'\n"," pixel_black.gif\n"," pixel_blue.gif\n"," pixel_lblue.gif\n"," pkg_graf_applicant.p_sos_pdf.pdf\n","'Porfolio_Mina Kang.gslides'\n","'Prep Semester Study.gdoc'\n","'Prep Semester Study.pdf'\n","'project 1'\n","'Project 1.gslides'\n","'Project 2.gslides'\n","'Project 3 .gslides'\n"," Projects\n","'Proposal for the Paul Villeneuve Lab Website.gdoc'\n"," proposal.gdoc\n","'QC-Consent-Firstname-Lastname (1).pdf'\n"," QC-Consent-Firstname-Lastname.pdf\n","'Quiz Preparation Guide.gdoc'\n"," Receipt.pdf\n","'report- mouse facial expression.gdoc'\n","'Resume_Classup_Mina Kang.gdoc'\n","'Resume_Enhanced AI agent to Mindsherpa.gdoc'\n"," Resume.gdoc\n","'Resume_Mina Kang_ESP.gdoc'\n","'Resume_Mina Kang_March Networks.gdoc'\n","'Resume_Mina Kang_Ottawa Heart Institute.gdoc'\n","'Rresume_Mina Kang_Lamour.gdoc'\n"," script.gdoc\n"," Script.gdoc\n"," segmented\n","'Selected Recent Publications.gdoc'\n","'sfn christmas party.gdoc'\n","'statement of stnading on admision.pdf'\n","'Student permit'\n","'Student Permit Letter_Mina Kang.pdf'\n","'summer mood board 2025.gslides'\n","'table and chair.pptx'\n","'table for prep study.pdf'\n","'telfer--andre--deep-learning-scoring-of-negative-affect-from-mouse-facial-expressions (1).pdf'\n"," telfer--andre--deep-learning-scoring-of-negative-affect-from-mouse-facial-expressions.pdf\n"," Terms-and-Conditions-May-2025-to-April-2026.pdf\n","'Training Requirements for Lab Work_Dept of Neuroscience.pdf'\n"," TranscriptRequestForm.pdf\n"," tuition.pdf\n","'Untitled document (1).gdoc'\n","'Untitled document (2).gdoc'\n","'Untitled document (3).gdoc'\n","'Untitled document (4).gdoc'\n","'Untitled document (5).gdoc'\n","'Untitled document (6).gdoc'\n","'Untitled document.gdoc'\n","'Untitled spreadsheet (1).gsheet'\n","'Untitled spreadsheet (2).gsheet'\n","'Untitled spreadsheet.gsheet'\n"," visa.pdf\n","'vlogging ğŸ¥'\n","'Website Code Backup (Copy and Pasted on December 18, 2024).docx'\n","'Website Info.docx'\n"," wild-type\n","'working holiday visa.pdf'\n","'á„€á…¢á„‹á…µá†« á„‰á…¡á„Œá…µá†«'\n","'á„€á…¢á„‹á…µá†«á„Œá…¥á†¼á„‡á…© á„‰á…®á„Œá…µá†¸ á„‹á…µá„‹á…­á†¼á„ƒá…©á†¼á„‹á…´á„‰á…¥.pdf'\n","'á„€á…©á†¼á„ƒá…©á†¼á„‹á…§á†«á„€á…®á„Œá…¡ á„‡á…©á„‹á…¡á†« á„‰á…¥á„‹á…£á†¨á„‰á…¥.pdf'\n","'á„€á…ªá„Œá…¦ 2 á„á…¬á„Œá…©á†¼'\n","'á„ƒá…©á†¼á„†á…®á†¯ á„’á…¢á†¼á„ƒá…©á†¼ á„‡á…®á†«á„‰á…¥á†¨ á„ƒá…¢á„‰á…µá„‡á…©á„ƒá…³ á„‰á…µá„‰á…³á„á…¦á†· á„‹á…¡á„á…µá„á…¦á†¨á„á…¥ á„Œá…¦á„‹á…¡á†«.pdf'\n","'á„‹á…§á†«á„€á…®á„’á…­á„‹á…²á†¯á„‰á…¥á†¼á„‹á…³á†¯á„‹á…±á„’á…¡á†« AI.pdf'\n","'á„‹á…§á†¼á„†á…®á†«_á„Œá…¥á†«á„Œá…¡á„€á…¡á„Œá…©á†¨á„€á…ªá†«á„€á…¨_á„€á…¡á†¼á„†á…µá†«á„‹á…¡ (1).pdf'\n"," á„‹á…§á†¼á„†á…®á†«_á„Œá…¥á†«á„Œá…¡á„€á…¡á„Œá…©á†¨á„€á…ªá†«á„€á…¨_á„€á…¡á†¼á„†á…µá†«á„‹á…¡.pdf\n","'á„‹á…µá„Œá…¦ á„ƒá…¡á„‹á…³á†· á„ƒá…¦á„‹á…µá„á…¥á„…á…³á†¯ spssá„…á…© á„á…³á†¯á„…á…µá„‚á…µá†¼ á„’á…¡á„‚á…³á†« á„Œá…¡á†¨á„‹á…¥á†¸á„‡á…®á„á…¥ á„ƒá…©á„‹á…ªá„Œá…¯.gsheet'\n","'á„‹á…µá„Œá…¦ á„‡á…©á„€á…©á„‰á…¥ á„Œá…¡á†¨á„‰á…¥á†¼á„‹á…³á†¯ á„ƒá…©á„‹á…ªá„Œá…¯.gdoc'\n","'á„‹á…µá†¯á„Œá…¥á†¼ á„Œá…¡á„ƒá…©á†¼á„’á…ª.gsheet'\n"," á„Œá…¡á„‰á…¡á†«á„€á…ªá†«á„…á…µ.gsheet\n"," á„Œá…¡á†«á„€á…©á„Œá…³á†¼á„†á…§á†¼_á„‰á…µá†«á„’á…¡á†«á„‹á…³á†«á„’á…¢á†¼_250530.jpg\n","'á„Œá…± á„‘á…­á„Œá…¥á†¼ á„‡á…®á†«á„‰á…¥á†¨ á„‹á…§á†«á„€á…® á„’á…ªá†¨á„Œá…¡á†¼'$'\\n''.gdoc'\n","'á„Œá…µá„‹á…¯á†« á„’á…§á†«á„’á…ªá†¼.xlsx'\n","'á„‘á…³á„…á…µá„Œá…¦á†«á„á…¦á„‹á…µá„‰á…§á†«á„‹á…¦ á„‚á…¥á‡‚á„‹á…³á†¯ á„‹á…¡á„‹á…µá„á…©á†«á„‹á…µá„‚á…¡ figureá„ƒá…© á„‡á…©á„‚á…¢á„Œá…¯.gdoc'\n","'á„‘á…³á†¯á„…á…¢á†ºá„‘á…©á†· á„€á…µá„‚á…³á†¼ á„†á…©á†¨á„…á…©á†¨.gdoc'\n","' á„’á…¢á†¼á„ƒá…©á†¼ á„‡á…®á†«á„‰á…¥á†¨ á„‘á…³á†¯á„…á…¢á†ºá„‘á…©á†·á„‹á…¦á„‰á…¥ á„‰á…¡á„‹á…­á†¼á„’á…¡á„‚á…³á†« á„Œá…®á„‹á…­ á„Œá…µá„‘á…­ (4á„€á…¡á„Œá…µ).gdoc'\n","'á„’á…§á†«á„Œá…¢ Abizaid Labá„‹á…¦á„‰á…¥ á„ƒá…¦á„‹á…µá„á…¥ á„‰á…¡á„‹á…µá„‹á…¥á†«á„á…µá„‰á…³á„á…³á„…á…© á„‹á…µá†¯á„’á…¡á„‚á…³á†« á„Œá…®á†¼á„‹á…µá„€á…©, á„‹á…§á†«á„€á…®á„‰á…µá†¯ á„‰á…¡á„…á…¡á†·á„ƒá…³á†¯á„‹á…³á†¯ á„ƒá…¢á„‰á…¡á†¼....gdoc'\n"]}]},{"cell_type":"code","execution_count":25,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"f6nfMoDESkUv","executionInfo":{"status":"ok","timestamp":1763912465829,"user_tz":300,"elapsed":320,"user":{"displayName":"Mina Kang","userId":"09171318576601785204"}},"outputId":"bb3fd07f-7adb-4a36-8d41-5fd604473472"},"outputs":[{"output_type":"stream","name":"stdout","text":["cp: missing destination file operand after '/content/drive/MyDrive/mouse-facial-expressions-2023-main'\n","Try 'cp --help' for more information.\n","fatal: destination path 'mouse-facial-expressions-2023' already exists and is not an empty directory.\n","/content/drive/MyDrive/mouse-facial-expressions-2023-main\n"]}],"source":["# í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ ì„¤ì •\n","import os\n","\n","# Google Driveì—ì„œ ë³µì‚¬ (ê²½ë¡œ ìˆ˜ì • í•„ìš”)\n","!cp -r /content/drive/MyDrive/mouse-facial-expressions-2023-main\n","\n","# ë˜ëŠ” GitHubì—ì„œ í´ë¡ \n","!git clone https://github.com/A-Telfer/mouse-facial-expressions-2023.git\n","\n","os.chdir('/content/drive/MyDrive/mouse-facial-expressions-2023-main')\n","!pwd"]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"pY-ob-g3Vy_o","executionInfo":{"status":"ok","timestamp":1763911876861,"user_tz":300,"elapsed":462,"user":{"displayName":"Mina Kang","userId":"09171318576601785204"}},"outputId":"50fd7d5d-ca44-42dd-dd5c-2e1b39106078"},"execution_count":10,"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}]},{"cell_type":"markdown","metadata":{"id":"3ziEYleFSkUv"},"source":["## Step 2: ë°ì´í„° ì¤€ë¹„\n","\n","ë¡œì»¬ì—ì„œ ì¤€ë¹„í•œ ë°ì´í„°ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”:\n","- `data/local_frames/` - ì´ë¯¸ì§€ í”„ë ˆì„\n","- `data/raw/treatments.csv` - ì¹˜ë£Œ ë©”íƒ€ë°ì´í„°\n","- `data/raw/raw_videos.csv` - ë¹„ë””ì˜¤ ë©”íƒ€ë°ì´í„°\n","- `data/processed/task-1.1/` - ìƒì„±ëœ ë°ì´í„°ì…‹"]},{"cell_type":"code","execution_count":26,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"E4KJrQ8XSkUv","executionInfo":{"status":"ok","timestamp":1763912481366,"user_tz":300,"elapsed":9153,"user":{"displayName":"Mina Kang","userId":"09171318576601785204"}},"outputId":"286aa352-650e-4e45-d2cb-4f67c986a7ce"},"outputs":[{"output_type":"stream","name":"stdout","text":["total 5.9M\n","-rw------- 1 root root 1.5M Nov 23 14:19 dataset_df.pkl\n","-rw------- 1 root root 169K Nov 23 14:20 eval.pkl\n","-rw------- 1 root root 539K Nov 23 14:19 fold0.pkl\n","-rw------- 1 root root 539K Nov 23 14:19 fold1.pkl\n","-rw------- 1 root root 539K Nov 23 14:19 fold2.pkl\n","-rw------- 1 root root 539K Nov 23 14:19 fold3.pkl\n","-rw------- 1 root root 539K Nov 23 14:20 fold4.pkl\n","-rw------- 1 root root 539K Nov 23 14:20 fold5.pkl\n","-rw------- 1 root root 539K Nov 23 14:20 fold6.pkl\n","-rw------- 1 root root 539K Nov 23 14:20 fold7.pkl\n","-rw------- 1 root root  395 Nov 23 14:19 README.txt\n"]}],"source":["# ë°ì´í„° í™•ì¸\n","!ls -lh data/processed/task-1.1/"]},{"cell_type":"markdown","metadata":{"id":"PRg5GdulSkUv"},"source":["## Step 3: í™˜ê²½ ë³€ìˆ˜ ì„¤ì •"]},{"cell_type":"code","execution_count":27,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"QuPalPi4SkUv","executionInfo":{"status":"ok","timestamp":1763912484879,"user_tz":300,"elapsed":538,"user":{"displayName":"Mina Kang","userId":"09171318576601785204"}},"outputId":"fbb6e974-e6c4-4e91-b8db-7a675528ea20"},"outputs":[{"output_type":"stream","name":"stdout","text":["âœ… Environment configured\n"]}],"source":["# .env íŒŒì¼ ìƒì„±\n","env_content = \"\"\"\n","MFE_RAW_VIDEO_FOLDER=/content/mouse-facial-expressions-2023-main/data/raw\n","MFE_RAW_CSV_FOLDER=/content/mouse-facial-expressions-2023-main/data/raw\n","MFE_VERSION=20230627\n","MFE_PROCESSED_VIDEO_FOLDER=/content/mouse-facial-expressions-2023-main/data/processed\n","MFE_EXTRACTED_FRAMES_FOLDER=/content/mouse-facial-expressions-2023-main/data/local_frames\n","MFE_TASKS=/content/mouse-facial-expressions-2023-main/data/processed\n","\"\"\"\n","\n","with open('.env', 'w') as f:\n","    f.write(env_content.strip())\n","\n","print(\"âœ… Environment configured\")"]},{"cell_type":"markdown","metadata":{"id":"vacfH0V4SkUv"},"source":["## Step 4: íŒ¨í‚¤ì§€ ì„¤ì¹˜"]},{"cell_type":"code","execution_count":28,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9aMikQUhSkUv","executionInfo":{"status":"ok","timestamp":1763912533603,"user_tz":300,"elapsed":46410,"user":{"displayName":"Mina Kang","userId":"09171318576601785204"}},"outputId":"c526a963-8d9b-42a8-dd55-1c035021c3ef"},"outputs":[{"output_type":"stream","name":"stdout","text":["Obtaining file:///content/drive/MyDrive/mouse-facial-expressions-2023-main\n","  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n","  Checking if build backend supports build_editable ... \u001b[?25l\u001b[?25hdone\n","  Getting requirements to build editable ... \u001b[?25l\u001b[?25hdone\n","  Preparing editable metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","Building wheels for collected packages: mouse_facial_expressions\n","  Building editable for mouse_facial_expressions (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for mouse_facial_expressions: filename=mouse_facial_expressions-0.1.0-0.editable-py3-none-any.whl size=3880 sha256=76c380d5662f31f7bb2cb03e8990786679dc18df58df865fcbacf261450fc374\n","  Stored in directory: /tmp/pip-ephem-wheel-cache-q1i6ee7w/wheels/f3/c7/1a/998566131bab05111a9fc38f2de0012195b9806fb14d500af7\n","Successfully built mouse_facial_expressions\n","Installing collected packages: mouse_facial_expressions\n","Successfully installed mouse_facial_expressions-0.1.0\n"]}],"source":["# í”„ë¡œì íŠ¸ íŒ¨í‚¤ì§€ ì„¤ì¹˜\n","!pip install -e ."]},{"cell_type":"markdown","metadata":{"id":"ENalm2XLSkUv"},"source":["## Step 5: í•™ìŠµ ì‹œì‘!"]},{"cell_type":"code","execution_count":29,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"pkL1wqTQSkUv","executionInfo":{"status":"ok","timestamp":1763912563014,"user_tz":300,"elapsed":28429,"user":{"displayName":"Mina Kang","userId":"09171318576601785204"}},"outputId":"db54c6fd-6822-469e-f158-82293a43ee06"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/mouse-facial-expressions-2023-main/mouse_facial_expressions/data/datasets.py:99: SyntaxWarning: invalid escape sequence '\\d'\n","  fold_df['fold_index'] = fold_df.foldpath.apply(lambda x: int(re.match('.*(\\d+)', x.parts[-1]).group(1)))\n","2025-11-23 15:42:33,194 - __main__ - INFO - beginning model run train_task1_baseline_model.py\n","/usr/local/lib/python3.12/dist-packages/mlflow/tracking/_tracking_service/utils.py:140: FutureWarning: Filesystem tracking backend (e.g., './mlruns') is deprecated. Please switch to a database backend (e.g., 'sqlite:///mlflow.db'). For feedback, see: https://github.com/mlflow/mlflow/issues/18534\n","  return FileStore(store_uri, store_uri)\n","2025-11-23 15:42:40,117 - __main__ - INFO - Started mlflow crossvalidation run ccffac5d753c4ee6b7b22d50137c0f0c\n","2025-11-23 15:42:40,117 - __main__ - INFO - Logging parameters\n","{\n","    \"epochs\": 10,\n","    \"dataset_version\": \"1.1\",\n","    \"train_batch_size\": 32,\n","    \"model\": 10,\n","    \"learning_rate\": 0.01,\n","    \"test_batch_size\": 50,\n","    \"warmup_steps\": 0,\n","    \"momentum\": 0.9,\n","    \"weight_decay\": 0.0001,\n","    \"warmup_decay\": 0.0001,\n","    \"label_smoothing\": 0.1,\n","    \"train_augmentation\": \"TrivialAugmentWide\",\n","    \"seed\": 97531\n","}\n","Traceback (most recent call last):\n","  File \"/content/drive/MyDrive/mouse-facial-expressions-2023-main/mouse_facial_expressions/models/train_task1_baseline_model.py\", line 236, in <module>\n","    main()\n","  File \"/usr/local/lib/python3.12/dist-packages/click/core.py\", line 1485, in __call__\n","    return self.main(*args, **kwargs)\n","           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n","  File \"/usr/local/lib/python3.12/dist-packages/click/core.py\", line 1406, in main\n","    rv = self.invoke(ctx)\n","         ^^^^^^^^^^^^^^^^\n","  File \"/usr/local/lib/python3.12/dist-packages/click/core.py\", line 1269, in invoke\n","    return ctx.invoke(self.callback, **ctx.params)\n","           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n","  File \"/usr/local/lib/python3.12/dist-packages/click/core.py\", line 824, in invoke\n","    return callback(*args, **kwargs)\n","           ^^^^^^^^^^^^^^^^^^^^^^^^^\n","  File \"/content/drive/MyDrive/mouse-facial-expressions-2023-main/mouse_facial_expressions/models/train_task1_baseline_model.py\", line 159, in main\n","    cv = Task1Folds(version=config['dataset_version'], train_augmentation=config['train_augmentation'])\n","         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n","  File \"/content/drive/MyDrive/mouse-facial-expressions-2023-main/mouse_facial_expressions/data/datasets.py\", line 95, in __init__\n","    self.df = pd.read_pickle(task1_path / 'dataset_df.pkl')\n","              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n","  File \"/usr/local/lib/python3.12/dist-packages/pandas/io/pickle.py\", line 185, in read_pickle\n","    with get_handle(\n","         ^^^^^^^^^^^\n","  File \"/usr/local/lib/python3.12/dist-packages/pandas/io/common.py\", line 882, in get_handle\n","    handle = open(handle, ioargs.mode)\n","             ^^^^^^^^^^^^^^^^^^^^^^^^^\n","FileNotFoundError: [Errno 2] No such file or directory: '/content/mouse-facial-expressions-2023-main/data/processed/task-1.1/dataset_df.pkl'\n"]}],"source":["# í•™ìŠµ ì‹¤í–‰\n","!python mouse_facial_expressions/models/train_task1_baseline_model.py \\\n","    --epochs 10 \\\n","    --dataset_version \"1.1\" \\\n","    --train_batch_size 32"]},{"cell_type":"markdown","metadata":{"id":"iEskEuIGSkUv"},"source":["## Step 6: ê²°ê³¼ í™•ì¸"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"q87YsvinSkUv","executionInfo":{"status":"aborted","timestamp":1763911084834,"user_tz":300,"elapsed":40034,"user":{"displayName":"Mina Kang","userId":"09171318576601785204"}}},"outputs":[],"source":["# ì €ì¥ëœ ì²´í¬í¬ì¸íŠ¸ í™•ì¸\n","!ls -lh models/checkpoints/"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cOWkp3xtSkUv","executionInfo":{"status":"aborted","timestamp":1763911084838,"user_tz":300,"elapsed":40038,"user":{"displayName":"Mina Kang","userId":"09171318576601785204"}}},"outputs":[],"source":["# ì²´í¬í¬ì¸íŠ¸ ë‹¤ìš´ë¡œë“œ\n","from google.colab import files\n","\n","# ìµœê³  ì„±ëŠ¥ ëª¨ë¸ ì°¾ê¸°\n","import glob\n","checkpoints = glob.glob('models/checkpoints/*.ckpt')\n","if checkpoints:\n","    latest_checkpoint = max(checkpoints, key=os.path.getctime)\n","    print(f\"Downloading: {latest_checkpoint}\")\n","    files.download(latest_checkpoint)\n","else:\n","    print(\"No checkpoints found\")"]},{"cell_type":"markdown","metadata":{"id":"uOB94Zc2SkUv"},"source":["## Step 7: Google Driveì— ì €ì¥ (ì„ íƒì‚¬í•­)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pDUw56ToSkUv","executionInfo":{"status":"aborted","timestamp":1763911084839,"user_tz":300,"elapsed":40038,"user":{"displayName":"Mina Kang","userId":"09171318576601785204"}}},"outputs":[],"source":["# ì²´í¬í¬ì¸íŠ¸ë¥¼ Google Driveì— ë³µì‚¬\n","!mkdir -p /content/drive/MyDrive/mouse_model_checkpoints\n","!cp -r models/checkpoints/* /content/drive/MyDrive/mouse_model_checkpoints/\n","print(\"âœ… Checkpoints saved to Google Drive\")"]},{"cell_type":"markdown","metadata":{"id":"EdUd4x4aSkUw"},"source":["## ì™„ë£Œ!\n","\n","í•™ìŠµëœ ê°€ì¤‘ì¹˜ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ë¡œì»¬ì—ì„œ chronic ë°ì´í„° fine-tuningì— ì‚¬ìš©í•˜ì„¸ìš”.\n","\n","### ë‹¤ìŒ ë‹¨ê³„:\n","1. ì²´í¬í¬ì¸íŠ¸ íŒŒì¼ ë‹¤ìš´ë¡œë“œ\n","2. ë¡œì»¬ `models/checkpoints/` í´ë”ì— ë³µì‚¬\n","3. `FINE_TUNING_GUIDE.md` ì°¸ê³ í•˜ì—¬ chronic ë°ì´í„°ë¡œ fine-tuning"]}],"metadata":{"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.0"},"colab":{"provenance":[],"gpuType":"T4"},"accelerator":"GPU"},"nbformat":4,"nbformat_minor":0}